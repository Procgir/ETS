## –¶–µ–ª–∏ –∏ –∑–∞–¥–∞—á–∏
–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ [–ß–∏—Å—Ç–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ ](https://blog.cleancoder.com/uncle-bob/2012/08/13/the-clean-architecture.html)(CleanArchitecture), [–ü—Ä–µ–¥–º–µ—Ç–Ω–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –ø–æ–¥—Ö–æ–¥–µ ](https://ru.wikipedia.org/wiki/%D0%9F%D1%80%D0%B5%D0%B4%D0%BC%D0%B5%D1%82%D0%BD%D0%BE-%D0%BE%D1%80%D0%B8%D0%B5%D0%BD%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%BD%D0%BE%D0%B5_%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5)([DDD](https://www.youtube.com/watch?v=6_BhdXLxiic)) –∏ –æ—Å–≤–æ–∏—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É —Å –ø–æ–º–æ—â—å—é —ç—Ç–∏—Ö –ø–æ–¥—Ö–æ–¥–æ–≤ –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ –°–∏—Å—Ç–µ–º—ã –≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —Å –ø–æ–º–æ—â—å—é Keycloak
- –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é Serlilog
- –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é Redis
- —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å ApiVersioning (Swagger)
- —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å HealthChecks –ø–æ–¥—Ö–æ–¥
- —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å OutboxPattern –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Quartz

---
## –¢–µ–æ—Ä–∏—è

**Cross-cutting concerns**  ‚Äî —ç—Ç–æ –∞—Å–ø–µ–∫—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞—é—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –∏–ª–∏ —Å–ª–æ—ë–≤ —Å–∏—Å—Ç–µ–º—ã, –Ω–æ –Ω–µ –≤—Ö–æ–¥—è—Ç –≤ –æ—Å–Ω–æ–≤–Ω—É—é –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É. –û–Ω–∏ —á–∞—Å—Ç–æ –ø—Ä–∏–≤–æ–¥—è—Ç –∫ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—é –∫–æ–¥–∞ –∏ –Ω–∞—Ä—É—à–µ–Ω–∏—é –ø—Ä–∏–Ω—Ü–∏–ø–∞ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏.

üîç –ß—Ç–æ —Ç–∞–∫–æ–µ Cross-Cutting Concerns?

–≠—Ç–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤–æ –º–Ω–æ–≥–∏—Ö —á–∞—Å—Ç—è—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –Ω–æ –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –æ—Ç–Ω–æ—Å—è—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é –∫ –µ–≥–æ –æ—Å–Ω–æ–≤–Ω–æ–π –∑–∞–¥–∞—á–µ. –ü—Ä–∏–º–µ—Ä—ã –≤–∫–ª—é—á–∞—é—Ç:
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è**
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**
- **–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞**
- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ä–µ–¥—ã

–≠—Ç–∏ concerns —á–∞—Å—Ç–æ –ø—Ä–∏–≤–æ–¥—è—Ç –∫ **scattering** (—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é –∫–æ–¥–∞ –ø–æ –≤—Å–µ–º—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é) –∏ **tangling** (–ø–µ—Ä–µ–ø–ª–µ—Ç–µ–Ω–∏—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏), —á—Ç–æ –∑–∞—Ç—Ä—É–¥–Ω—è–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫—É –∏ —Ä–∞–∑–≤–∏—Ç–∏–µ —Å–∏—Å—Ç–µ–º—ã.

üõ†Ô∏è –ö–∞–∫ —É–ø—Ä–∞–≤–ª—è—Ç—å Cross-Cutting Concerns?

–î–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫—Ä–æ—Å—Å-–æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∏–º–∏ –ø—Ä–æ–±–ª–µ–º–∞–º–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ –ø–æ–¥—Ö–æ–¥—ã:
- **–ê—Å–ø–µ–∫—Ç–Ω–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ (AOP)**: –ü–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–¥–µ–ª–∏—Ç—å concerns –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏ (–∞—Å–ø–µ–∫—Ç—ã), –∫–æ—Ç–æ—Ä—ã–µ –≤–Ω–µ–¥—Ä—è—é—Ç—Å—è –≤ –Ω—É–∂–Ω—ã–µ –º–µ—Å—Ç–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã.
- **–ú–∏–¥–ª–≤–∞—Ä—å –∏ —Ñ–∏–ª—å—Ç—Ä—ã**: –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è).
- **–ò–Ω—Ç–µ—Ä—Å–µ–ø—Ç–æ—Ä—ã –∏ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã**: –ü—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –¥–ª—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ –≤—ã–∑–æ–≤–æ–≤ –º–µ—Ç–æ–¥–æ–≤ –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ª–æ–≥–∏–∫–∏.
- **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∏ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∏**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ–±—â–∏—Ö —Ä–µ—à–µ–Ω–∏–π –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫—Ä–æ—Å—Å-–æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∏—Ö –ø—Ä–æ–±–ª–µ–º –≤–æ –≤—Å–µ–π —Å–∏—Å—Ç–µ–º–µ.

[Cross-cutting concern ‚Äî Wikipedia](https://en.wikipedia.org/wiki/Cross-cutting_concern)

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è/–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
–í ASP.NET Core –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —è–≤–ª—è—é—Ç—Å—è –∫–ª—é—á–µ–≤—ã–º–∏ –∞—Å–ø–µ–∫—Ç–∞–º–∏ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –∏ API. –û–Ω–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∫ —Ä–µ—Å—É—Ä—Å–∞–º –∏ –∑–∞—â–∏—â–∞—Ç—å –¥–∞–Ω–Ω—ã–µ.

üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –≤ ASP.NET Core

**–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** ‚Äî —ç—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —Ç–æ –µ—Å—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ, –∫—Ç–æ –æ–Ω —Ç–∞–∫–æ–π.

–û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ö–µ–º—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏:

- **Cookie-based Authentication**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, –≥–¥–µ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—Ö–æ–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É—é—Ç —Å –ø–æ–º–æ—â—å—é cookie.
- **JWT (JSON Web Token)**: –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –≤ API –∏ SPA-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö. –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å–µ—Ä–≤–µ—Ä –≤—ã–¥–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç—É —Ç–æ–∫–µ–Ω, –∫–æ—Ç–æ—Ä—ã–π —Ç–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ Authorization –ø—Ä–∏ –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö.
- **OAuth 2.0 / OpenID Connect**: –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –≤–Ω–µ—à–Ω–∏–º–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏, —Ç–∞–∫–∏–º–∏ –∫–∞–∫ Google, Facebook, Microsoft –∏ –¥—Ä—É–≥–∏–µ. [fuse8.ru](https://fuse8.ru/articles/secure-authorization-with-jwt?)

–ü—Ä–∏–º–µ—Ä –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ JWT-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏:
```
builder.Services.AddAuthentication(JwtBearerDefaults.AuthenticationScheme)
    .AddJwtBearer(options =>
    {
        options.TokenValidationParameters = new TokenValidationParameters
        {
            ValidateIssuer = true,
            ValidateAudience = true,
            ValidateLifetime = true,
            ValidateIssuerSigningKey = true,
            ValidIssuer = builder.Configuration["Jwt:Issuer"],
            ValidAudience = builder.Configuration["Jwt:Audience"],
            IssuerSigningKey = new SymmetricSecurityKey(Encoding.UTF8.GetBytes(builder.Configuration["Jwt:Key"]))
        };
    });
```

üõ°Ô∏è –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤ ASP.NET Core
**–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è** ‚Äî —ç—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, –∫–∞–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã –∫ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:
- **–†–æ–ª–µ–≤–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (Role-based Authorization)**: –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫ —Ä–µ—Å—É—Ä—Å–∞–º –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–æ–ª–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.[run-dev](https://run-dev.ru/csharp/autentifikacziya-i-avtorizacziya-api-v-asp-net-core-csharp/?)
- **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π (Claims-based Authorization)**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è (claims), —Ç–∞–∫–∏–µ –∫–∞–∫ "email", "age", "permissions", –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π –æ –¥–æ—Å—Ç—É–ø–µ.[Microsoft Learn+1run-dev+1](https://learn.microsoft.com/ru-ru/aspnet/core/security/authentication/identity?view=aspnetcore-9.0&)
- **–ü–æ–ª–∏—Ç–∏–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (Policy-based Authorization)**: –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç –±–æ–ª–µ–µ –≥–∏–±–∫–∏–π —Å–ø–æ—Å–æ–± –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –¥–æ—Å—Ç—É–ø–∞, –∫–æ–º–±–∏–Ω–∏—Ä—É—è —Ä–∞–∑–ª–∏—á–Ω—ã–µ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∏ —Ä–æ–ª–∏.
- **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ—Å—É—Ä—Å–æ–≤ (Resource-based Authorization)**: –û—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º —Ä–µ—Å—É—Ä—Å–∞–º, –Ω–∞–ø—Ä–∏–º–µ—Ä, –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º, –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—â–∏–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.

```
[Authorize(Roles = "Admin")]
public class AdminController : Controller
{
    public IActionResult Index()
    {
        return View();
    }
}
```

–í –¥–∞–Ω–Ω–æ–º –ø—Ä–∏–º–µ—Ä–µ –¥–æ—Å—Ç—É–ø –∫ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—É `AdminController` –æ–≥—Ä–∞–Ω–∏—á–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏, –∏–º–µ—é—â–∏–º–∏ —Ä–æ–ª—å "Admin".[run-dev](https://run-dev.ru/csharp/autentifikacziya-i-avtorizacziya-api-v-asp-net-core-csharp/?)

üß© –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

–î–ª—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ middleware –≤ –∫–æ–Ω–≤–µ–π–µ—Ä–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤:


```
app.UseAuthentication(); 
app.UseAuthorization();
```

–≠—Ç–∏ —Å—Ç—Ä–æ–∫–∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –ø—Ä–æ–≤–µ—Ä–∫—É –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –æ—Ü–µ–Ω–∫—É –µ–≥–æ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –ø–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º –∑–∞–ø—Ä–æ—Å–∞.

**–ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏:**
- [–û–±—â–∏–µ —Å–≤–µ–¥–µ–Ω–∏—è –æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ ASP.NET Core](https://learn.microsoft.com/ru-ru/aspnet/core/security/authorization/introduction?view=aspnetcore-9.0)
- [–ü—Ä–æ—Å—Ç–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤ ASP.NET Core](https://learn.microsoft.com/ru-ru/aspnet/core/security/authorization/simple?view=aspnetcore-9.0)
- [–í–≤–µ–¥–µ–Ω–∏–µ –≤ Identity –Ω–∞ ASP.NET Core](https://learn.microsoft.com/ru-ru/aspnet/core/security/authentication/identity?view=aspnetcore-9.0)

**KeyCloak**
- **Keycloak** ‚Äî open-source —Å–µ—Ä–≤–µ—Ä –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏, –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π –ø–æ OAuth2/OpenID Connect.
- Asp.Net Core –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è —Å Keycloak —á–µ—Ä–µ–∑ OpenID Connect.
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ middleware `AddAuthentication().AddOpenIdConnect()`.
- Keycloak –≤—ã—Å—Ç—É–ø–∞–µ—Ç –≤ —Ä–æ–ª–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ Identity (Identity Provider, IdP).

**–ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏:**
- [–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Keycloak: ](https://www.keycloak.org/documentation)
- [–ü—Ä–∏–º–µ—Ä –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Asp.Net Core ](https://medium.com/swlh/asp-net-core-keycloak-integration-with-openid-connect-7a1444463997)
-  [Microsoft Docs –ø–æ OpenID Connect:](https://learn.microsoft.com/en-us/aspnet/core/security/authentication/openid-connect)
### –õ–æ–≥–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
–õ–æ–≥–≥–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Äî —ç—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–ø–∏—Å–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ä–∞–±–æ—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: –æ—à–∏–±–æ–∫, –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π, —Å–æ–±—ã—Ç–∏–π, –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∏ —Ç.–¥. –≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç:
- –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- –î–∏–∞–≥–Ω–æ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫–∏ –∏ –Ω–µ–∏—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç–∏
- –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –í–µ—Å—Ç–∏ –∞—É–¥–∏—Ç –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

–í ASP.NET Core –µ—Å—Ç—å –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º –ª–æ–≥–≥–∏—Ä–æ–≤–∞–Ω–∏—è ‚Äî **ILogger**. –û–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ **Dependency Injection**, –∏ —Ç—ã –º–æ–∂–µ—à—å –ø–æ–ª—É—á–∏—Ç—å –µ–≥–æ –≤ –ª—é–±–æ–º —Å–µ—Ä–≤–∏—Å–µ, –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ –∏ —Ç.–¥.

```
public class HomeController : Controller
{
    private readonly ILogger<HomeController> _logger;

    public HomeController(ILogger<HomeController> logger)
    {
        _logger = logger;
    }

    public IActionResult Index()
    {
        _logger.LogInformation("Index page visited");
        return View();
    }
}
```
**Serilog**
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–≥–∏—Ä–æ–≤–∞–Ω–∏–µ.** Serilog —É–º–µ–µ—Ç –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ ‚Äî –Ω–µ –ø—Ä–æ—Å—Ç–æ —Å—Ç—Ä–æ–∫—É, –∞ –ø–∞—Ä—É "–∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–∏–µ". –≠—Ç–æ —É–ø—Ä–æ—â–∞–µ—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –∏ –∞–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤.
- **–ú–Ω–æ–≥–æ —Å–∏–Ω–≥–∫–æ–≤ (sink).** Sink ‚Äî —ç—Ç–æ –º–µ—Å—Ç–æ, –∫—É–¥–∞ –ø–∏—à—É—Ç—Å—è –ª–æ–≥–∏: –∫–æ–Ω—Å–æ–ª—å, —Ñ–∞–π–ª, –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö, Seq, ElasticSearch, –∏ –¥—Ä.
- **–ü—Ä–æ—Å—Ç–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è.** –õ–µ–≥–∫–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ –∫–æ–¥ –∏ –∫–æ–Ω—Ñ–∏–≥–∏.
- **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –∏ —É—Ä–æ–≤–Ω–µ–π –ª–æ–≥–æ–≤.**

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤**
```
dotnet add package Serilog.AspNetCore
dotnet add package Serilog.Sinks.Console
dotnet add package Serilog.Sinks.File
```
–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ `Program.cs`
```
`using Serilog;  var builder = WebApplication.CreateBuilder(args);  // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Serilog Log.Logger = new LoggerConfiguration()     .MinimumLevel.Debug()                   // –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è     .WriteTo.Console()                      // –õ–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª—å     .WriteTo.File("logs/myapp-.log", rollingInterval: RollingInterval.Day) // –õ–æ–≥–∏ –≤ —Ñ–∞–π–ª, –µ–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Ä–æ—Ç–∞—Ü–∏—è     .CreateLogger();  builder.Host.UseSerilog(); // –ü–æ–¥–∫–ª—é—á–∞–µ–º Serilog –∫–∞–∫ –ª–æ–≥–≥–µ—Ä –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è  var app = builder.Build();  app.MapGet("/", () => "Hello World!");  app.Run();`
```

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞—Ö –∏ —Å–µ—Ä–≤–∏—Å–∞—Ö
```
public class WeatherForecastController : ControllerBase
{
    private readonly ILogger<WeatherForecastController> _logger;

    public WeatherForecastController(ILogger<WeatherForecastController> logger)
    {
        _logger = logger;
    }

    [HttpGet]
    public IEnumerable<WeatherForecast> Get()
    {
        _logger.LogInformation("–ó–∞–ø—Ä–æ—Å –∫ WeatherForecast");
        return Enumerable.Empty<WeatherForecast>();
    }
}
```
–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞
```
_logger.LogInformation("User {UserId} logged in at {LoginTime}", user.Id, DateTime.UtcNow);
```
–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ —Ñ–∞–π–ª appsettings.json (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```
{
  "Serilog": {
    "MinimumLevel": {
      "Default": "Information",
      "Override": {
        "Microsoft": "Warning",
        "System": "Warning"
      }
    },
    "WriteTo": [
      { "Name": "Console" },
      {
        "Name": "File",
        "Args": {
          "path": "logs/log-.txt",
          "rollingInterval": "Day"
        }
      }
    ]
  }
}
```
–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```
{
  "Serilog": {
    "MinimumLevel": {
      "Default": "Information",
      "Override": {
        "Microsoft": "Warning",
        "System": "Warning"
      }
    },
    "WriteTo": [
      { "Name": "Console" },
      {
        "Name": "File",
        "Args": {
          "path": "logs/log-.txt",
          "rollingInterval": "Day"
        }
      }
    ]
  }
}

Log.Logger = new LoggerConfiguration()
    .ReadFrom.Configuration(builder.Configuration)
    .CreateLogger();
```
[Serilog –î–æ–∫–∞](https://serilog.net/)
[Serilog –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ AspNetCore](https://github.com/serilog/serilog-aspnetcore)
[–°—Ç–∞—Ç—å—è](https://habr.com/ru/articles/550582/)
### –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Äî —ç—Ç–æ —Å–ø–æ—Å–æ–± **–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö** –≤ –±—ã—Å—Ç—Ä–æ–º –¥–æ—Å—Ç—É–ø–µ, —á—Ç–æ–±—ã –Ω–µ –¥–µ–ª–∞—Ç—å –¥–æ—Ä–æ–≥–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∑–∞–ø—Ä–æ—Å –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ —Å–ª–æ–∂–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è) –∫–∞–∂–¥—ã–π —Ä–∞–∑ –∑–∞–Ω–æ–≤–æ.

**–ü—Ä–∏–º–µ—Ä:**  
–ü—Ä–µ–¥—Å—Ç–∞–≤—å, —á—Ç–æ —É —Ç–µ–±—è –µ—Å—Ç—å —Å–∞–π—Ç —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –ø–æ–≥–æ–¥–µ. –ö–∞–∂–¥—ã–π —Ä–∞–∑ –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ –≤–Ω–µ—à–Ω–µ–º—É —Å–µ—Ä–≤–∏—Å—É –ø–æ–≥–æ–¥—ã –¥–æ—Ä–æ–≥–æ –∏ –¥–æ–ª–≥–æ. –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ —Ç—ã –º–æ–∂–µ—à—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –∫–µ—à, –∏, –µ—Å–ª–∏ –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–∏—Ö–æ–¥—è—Ç —á–∞—Å—Ç–æ, –æ—Ç–¥–∞–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ –∫–µ—à–∞, –ø–æ–∫–∞ –æ–Ω–∏ –Ω–µ —É—Å—Ç–∞—Ä–µ–ª–∏.

**Redis** ‚Äî —ç—Ç–æ –ø–æ–ø—É–ª—è—Ä–Ω—ã–π **–±—ã—Å—Ç—Ä—ã–π in-memory (–≤ –ø–∞–º—è—Ç–∏) key-value —Ö—Ä–∞–Ω–∏–ª–∏—â–µ**.  
–û–Ω –æ—á–µ–Ω—å —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è, –ø–æ—Ç–æ–º—É —á—Ç–æ —Ö—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ –≤ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –Ω–∏–º –æ—á–µ–Ω—å –±—ã—Å—Ç—Ä—ã–º.

–í ASP.NET Core Redis —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ –¥–ª—è —Å–µ—Å—Å–∏–π, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω –±—ã—Å—Ç—Ä—ã–π –∏ –ø—Ä–æ—Å—Ç–æ–π –≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏.

**–í–∞—Ä–∏–∞–Ω—Ç—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è Redis –≤ ASP.NET Core:**

1. **Distributed Cache (—Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–π –∫–µ—à)**  
    ASP.NET Core –∏–º–µ–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `IDistributedCache` ‚Äî –∞–±—Å—Ç—Ä–∞–∫—Ü–∏—é –¥–ª—è –∫–µ—à–∞, –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å –ø–æ–º–æ—â—å—é Redis. –≠—Ç–æ —É–¥–æ–±–Ω–æ, –µ—Å–ª–∏ —É —Ç–µ–±—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ—Ä–≤–µ—Ä–æ–≤, –∏ –∫–µ—à –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –æ–±—â–∏–º –¥–ª—è –≤—Å–µ—Ö.
2. **Session Storage**  
    –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Redis –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–µ—Å—Å–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ‚Äî —ç—Ç–æ –ø–æ–ª–µ–∑–Ω–æ, –∫–æ–≥–¥–∞ —É —Ç–µ–±—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ—Ä–≤–µ—Ä–æ–≤ –∏ –Ω—É–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Å–µ—Å—Å–∏–∏ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ.
3. **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏** ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç—è–∂–µ–ª—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤, –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü –∏–ª–∏ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤.

**–û—Å–Ω–æ–≤–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ Redis:**
- –û—á–µ–Ω—å –±—ã—Å—Ç—Ä–∞—è —Ä–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ (–º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—ã)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä –¥–∞–Ω–Ω—ã—Ö: —Å—Ç—Ä–æ–∫–∏, —Å–ø–∏—Å–∫–∏, –º–Ω–æ–∂–µ—Å—Ç–≤–∞, —Ö–µ—à–∏ –∏ –¥—Ä.
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ TTL (time-to-live) ‚Äî –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ –∫–µ—à–∞
- –†–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç—å ‚Äî –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ

**–ö–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å Redis –≤ ASP.NET Core (–∫—Ä–∞—Ç–∫–æ)**
```
#–ü–∞–∫–µ—Ç
dotnet add package Microsoft.Extensions.Caching.StackExchangeRedis

#–ö–æ–Ω—Ñ–∏–≥–∏
"Redis": {
  "Configuration": "localhost:6379"
}

#DI
builder.Services.AddStackExchangeRedisCache(options =>
{
    options.Configuration = builder.Configuration.GetSection("Redis")["Configuration"];
});

#–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
public class WeatherService
{
    private readonly IDistributedCache _cache;

    public WeatherService(IDistributedCache cache)
    {
        _cache = cache;
    }

    public async Task<string> GetWeatherAsync(string city)
    {
        string cacheKey = $"weather_{city}";
        var cachedData = await _cache.GetStringAsync(cacheKey);
        if (cachedData != null)
        {
            return cachedData; // –æ—Ç–¥–∞–µ–º –∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
        }

        // –ò–Ω–∞—á–µ –¥–µ–ª–∞–µ–º –∑–∞–ø—Ä–æ—Å –∫ API –ø–æ–≥–æ–¥—ã (—ç–º—É–ª—è—Ü–∏—è)
        string freshData = $"–ü–æ–≥–æ–¥–∞ –¥–ª—è {city} –Ω–∞ {DateTime.Now}";

        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∫–µ—à –Ω–∞ 5 –º–∏–Ω—É—Ç
        await _cache.SetStringAsync(cacheKey, freshData, new DistributedCacheEntryOptions
        {
            AbsoluteExpirationRelativeToNow = TimeSpan.FromMinutes(5)
        });

        return freshData;
    }
}
```

### ApiVersioning (–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ API)

–ö–æ–≥–¥–∞ —É —Ç–µ–±—è –µ—Å—Ç—å –ø—É–±–ª–∏—á–Ω–æ–µ API, —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º –ø–æ—è–≤–ª—è—é—Ç—Å—è –∏–∑–º–µ–Ω–µ–Ω–∏—è: –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –Ω–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏, –º–µ–Ω—è–µ—Ç—Å—è –ø–æ–≤–µ–¥–µ–Ω–∏–µ, —É–¥–∞–ª—è—é—Ç—Å—è —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –ø–æ–ª—è. –ß—Ç–æ–±—ã –Ω–µ —Å–ª–æ–º–∞—Ç—å —Å—Ç–∞—Ä—ã–µ –∫–ª–∏–µ–Ω—Ç—ã, –ø–æ–ª–µ–∑–Ω–æ **–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–µ—Ä—Å–∏–π API**.

–ù–∞–ø—Ä–∏–º–µ—Ä, –≤–µ—Ä—Å–∏—è 1 –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ –æ–¥–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ, –∞ –≤–µ—Ä—Å–∏—è 2 ‚Äî –Ω–µ–º–Ω–æ–≥–æ –ø–æ-–¥—Ä—É–≥–æ–º—É.


–°—É—â–µ—Å—Ç–≤—É–µ—Ç –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –ø–∞–∫–µ—Ç ‚Äî **Microsoft.AspNetCore.Mvc.Versioning**. –û–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤–µ—Ä—Å–∏–π.

 **–û—Å–Ω–æ–≤–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã —É–∫–∞–∑–∞–Ω–∏—è –≤–µ—Ä—Å–∏–∏ API:**
- –í URL: `/api/v1/products` –∏ `/api/v2/products`
- –í HTTP –∑–∞–≥–æ–ª–æ–≤–∫–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `api-version: 1.0`)
- –í query-–ø–∞—Ä–∞–º–µ—Ç—Ä–µ (`/api/products?api-version=1.0`)

```
#–ü–∞–∫–µ—Ç
dotnet add package Microsoft.AspNetCore.Mvc.Versioning

#DI
builder.Services.AddApiVersioning(options =>
{
    options.AssumeDefaultVersionWhenUnspecified = true; // –µ—Å–ª–∏ –≤–µ—Ä—Å–∏—è –Ω–µ —É–∫–∞–∑–∞–Ω–∞, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–µ—Ñ–æ–ª—Ç–Ω–∞—è
    options.DefaultApiVersion = new ApiVersion(1, 0);
    options.ReportApiVersions = true; // –≤ –æ—Ç–≤–µ—Ç–µ —É–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –≤–µ—Ä—Å–∏–∏
});

#–ü—Ä–∏–º–µ—Ä
[ApiController]
[Route("api/v{version:apiVersion}/[controller]")]
[ApiVersion("1.0")]
public class ProductsController : ControllerBase
{
    [HttpGet]
    public IActionResult GetV1() => Ok(new { Version = "v1", Products = new string[] { "Apple", "Banana" } });
}

[ApiController]
[Route("api/v{version:apiVersion}/[controller]")]
[ApiVersion("2.0")]
public class ProductsV2Controller : ControllerBase
{
    [HttpGet]
    public IActionResult GetV2() => Ok(new { Version = "v2", Products = new string[] { "Apple", "Banana", "Cherry" } });
}
```
–î–ª—è –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ Swagger –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –ø–æ –≤–µ—Ä—Å–∏—è–º.

–ü—Ä–∏–º–µ—Ä –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Swagger –¥–ª—è –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ API:
```
builder.Services.AddSwaggerGen(options =>
{
    var provider = builder.Services.BuildServiceProvider()
                       .GetRequiredService<IApiVersionDescriptionProvider>();

    foreach (var description in provider.ApiVersionDescriptions)
    {
        options.SwaggerDoc(description.GroupName, new Microsoft.OpenApi.Models.OpenApiInfo
        {
            Title = $"My API {description.ApiVersion}",
            Version = description.ApiVersion.ToString()
        });
    }
});

builder.Services.AddVersionedApiExplorer(options =>
{
    options.GroupNameFormat = "'v'VVV"; // –Ω–∞–ø—Ä–∏–º–µ—Ä, v1, v1.0
    options.SubstituteApiVersionInUrl = true;
});

var provider = app.Services.GetRequiredService<IApiVersionDescriptionProvider>();

app.UseSwagger();
app.UseSwaggerUI(options =>
{
    foreach (var description in provider.ApiVersionDescriptions)
    {
        options.SwaggerEndpoint($"/swagger/{description.GroupName}/swagger.json", description.GroupName.ToUpperInvariant());
    }
});
```
### HealthChecks
Health Checks ‚Äî —ç—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å, –≤ —Ä–∞–±–æ—á–µ–º –ª–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ —Ç–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ –µ–≥–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö, –∫–µ—à, —Å—Ç–æ—Ä–æ–Ω–Ω–∏–µ —Å–µ—Ä–≤–∏—Å—ã).

–≠—Ç–æ –≤–∞–∂–Ω–æ, —á—Ç–æ–±—ã:
- –ë—ã—Å—Ç—Ä–æ –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
- –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç—ã
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –≤—ã—Å–æ–∫—É—é –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∏ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å

–¢—ã —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—à—å –Ω–∞–±–æ—Ä –ø—Ä–æ–≤–µ—Ä–æ–∫ (health checks), –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –ø–æ –∑–∞–ø—Ä–æ—Å—É –Ω–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π endpoint (–æ–±—ã—á–Ω–æ `/health`).

–ü—Ä–∏–º–µ—Ä: –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö, Redis, –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å—Ç–æ—Ä–æ–Ω–Ω–µ–≥–æ API.

```
dotnet add package Microsoft.AspNetCore.Diagnostics.HealthChecks

builder.Services.AddHealthChecks()
    .AddSqlServer(configuration.GetConnectionString("DefaultConnection"))  // –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑—ã
    .AddRedis(configuration["Redis:Configuration"])                       // –ø—Ä–æ–≤–µ—Ä–∫–∞ Redis
    .AddUrlGroup(new Uri("https://externalapi.com/health"));              // –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–Ω–µ—à–Ω–µ–≥–æ API

app.MapHealthChecks("/health");
```
–ö–∞—Å—Ç–æ–º–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
```
public class CustomHealthCheck : IHealthCheck
{
    public Task<HealthCheckResult> CheckHealthAsync(HealthCheckContext context, CancellationToken cancellationToken = default)
    {
        bool isHealthy = true; // —Ç–≤–æ—è –ª–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏

        if (isHealthy)
        {
            return Task.FromResult(HealthCheckResult.Healthy("Everything is OK"));
        }
        else
        {
            return Task.FromResult(HealthCheckResult.Unhealthy("Something went wrong"));
        }
    }
}
```
### OutboxPattern
**Outbox Pattern** ‚Äî —ç—Ç–æ —à–∞–±–ª–æ–Ω –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–º–æ–≥–∞–µ—Ç –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å **–Ω–∞–¥–µ–∂–Ω—É—é –ø–µ—Ä–µ–¥–∞—á—É —Å–æ–æ–±—â–µ–Ω–∏–π –∏–ª–∏ —Å–æ–±—ã—Ç–∏–π –∏–∑ –æ–¥–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö) –≤ –¥—Ä—É–≥—É—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—á–µ—Ä–µ–¥—å —Å–æ–æ–±—â–µ–Ω–∏–π)**, –¥–∞–∂–µ –ø—Ä–∏ —Å–±–æ—è—Ö.

–ü—Ä–µ–¥—Å—Ç–∞–≤—å —Å–∏—Ç—É–∞—Ü–∏—é:
- –£ —Ç–µ–±—è –µ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –∏–∑–º–µ–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ –±–∞–∑–µ.
- –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω—É–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ –∏–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –æ—á–µ—Ä–µ–¥—å (RabbitMQ, Kafka –∏ —Ç.–ø.).

–ï—Å–ª–∏ –ø—Ä–æ—Å—Ç–æ –∏–∑–º–µ–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏ –æ—Ç–¥–µ–ª—å–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ, —Ç–æ:
- –ú–æ–∂–µ—Ç –ø—Ä–æ–∏–∑–æ–π—Ç–∏ —Å–±–æ–π –º–µ–∂–¥—É —ç—Ç–∏–º–∏ –¥–≤—É–º—è –¥–µ–π—Å—Ç–≤–∏—è–º–∏ ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–∞–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å, –∞ —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ –æ—Ç–ø—Ä–∞–≤–∏–ª–æ—Å—å, –∏–ª–∏ –Ω–∞–æ–±–æ—Ä–æ—Ç.
- –í –∏—Ç–æ–≥–µ –¥–∞–Ω–Ω—ã–µ –∏ —Å–æ–æ–±—â–µ–Ω–∏—è **–Ω–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω—ã** ‚Äî —ç—Ç–æ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è **–Ω–µ–∞—Ç–æ–º–∞—Ä–Ω–æ–π –æ–ø–µ—Ä–∞—Ü–∏–µ–π**.

**Outbox Pattern** —Ä–µ—à–∞–µ—Ç —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É.

–ò–¥–µ—è –ø—Ä–æ—Å—Ç–∞:
1. –í–º–µ—Å—Ç–æ —Ç–æ–≥–æ, —á—Ç–æ–±—ã —Å—Ä–∞–∑—É –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–±—ã—Ç–∏–µ –≤ –æ—á–µ—Ä–µ–¥—å, —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ–±—ã—Ç–∏–µ **–≤ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É (Outbox)** –≤–Ω—É—Ç—Ä–∏ —Ç–æ–π –∂–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –≥–¥–µ –º–µ–Ω—è–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.
2. –≠—Ç–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –ª–∏–±–æ –∏ –¥–∞–Ω–Ω—ã–µ, –∏ —Å–æ–±—ã—Ç–∏–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—Å—è, –ª–∏–±–æ –Ω–∏—á–µ–≥–æ –Ω–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è.
3. –û—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –∏–ª–∏ —Å–ª—É–∂–±–∞ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ —á–∏—Ç–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ —Ç–∞–±–ª–∏—Ü—ã Outbox –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏—Ö –≤ –æ—á–µ—Ä–µ–¥—å. –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ ‚Äî –ø–æ–º–µ—á–∞–µ—Ç –∏–ª–∏ —É–¥–∞–ª—è–µ—Ç –∑–∞–ø–∏—Å–∏ –∏–∑ Outbox

```
[–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –±–∞–∑—ã]
  - –û–±–Ω–æ–≤–∏—Ç—å –±–∏–∑–Ω–µ—Å-–¥–∞–Ω–Ω—ã–µ
  - –ó–∞–ø–∏—Å–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ –≤ —Ç–∞–±–ª–∏—Ü—É Outbox
[–û—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å]
  - –ß–∏—Ç–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –∏–∑ Outbox
  - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏—Ö –≤ –æ—á–µ—Ä–µ–¥—å —Å–æ–æ–±—â–µ–Ω–∏–π
  - –ü–æ–º–µ—á–∞–µ—Ç —Å–æ–±—ã—Ç–∏–µ –∫–∞–∫ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–µ
```
**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**
- **–ê—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å**: –¥–∞–Ω–Ω—ã–µ –∏ —Å–æ–±—ã—Ç–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –æ–¥–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏.
- **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å**: —Å–æ–æ–±—â–µ–Ω–∏—è —Ç–æ—á–Ω–æ –Ω–µ –ø–æ—Ç–µ—Ä—è—é—Ç—Å—è –¥–∞–∂–µ –ø—Ä–∏ —Å–±–æ—è—Ö.
- **–û—Ç–¥–µ–ª–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏**: –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –≤—ã–Ω–µ—Å–µ–Ω–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å, —á—Ç–æ —É–ø—Ä–æ—â–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ –∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏.

–ï—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–¥—Ö–æ–¥–æ–≤:
–†—É—á–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
- –°–æ–∑–¥–∞—ë—à—å —Ç–∞–±–ª–∏—Ü—É Outbox –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, SQL Server).
- –í –∫–æ–¥–µ —Å–µ—Ä–≤–∏—Å–∞, –∫–æ–≥–¥–∞ –º–µ–Ω—è–µ—à—å –¥–∞–Ω–Ω—ã–µ, –≤ —Ç–æ–π –∂–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –¥–æ–±–∞–≤–ª—è–µ—à—å –∑–∞–ø–∏—Å—å –≤ Outbox.
- –ü–∏—à–µ—à—å —Ñ–æ–Ω–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å (Hosted Service), –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ —á–∏—Ç–∞–µ—Ç –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è.

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫ –∏ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤
- **NServiceBus** ‚Äî –æ—á–µ–Ω—å –ø–æ–ø—É–ª—è—Ä–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π —Ä–µ–∞–ª–∏–∑—É–µ—Ç Outbox –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.
- **[CAP (dotnetcore/CAP)](https://github.com/dotnetcore/CAP)** ‚Äî open-source —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –∏ Outbox pattern.
- **MassTransit** —Ç–æ–∂–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç outbox-–º–æ–¥–µ–ª—å.

```
public class OutboxMessage
{
    public Guid Id { get; set; }
    public string Type { get; set; }
    public string Payload { get; set; }
    public DateTime CreatedAt { get; set; }
    public bool IsSent { get; set; }
}

using var transaction = await dbContext.Database.BeginTransactionAsync();

// –ú–µ–Ω—è–µ–º –±–∏–∑–Ω–µ—Å-–¥–∞–Ω–Ω—ã–µ
dbContext.Orders.Add(newOrder);

// –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–±—ã—Ç–∏–µ –≤ Outbox
dbContext.OutboxMessages.Add(new OutboxMessage
{
    Id = Guid.NewGuid(),
    Type = "OrderCreated",
    Payload = JsonSerializer.Serialize(orderDto),
    CreatedAt = DateTime.UtcNow,
    IsSent = false
});

await dbContext.SaveChangesAsync();
await transaction.CommitAsync();

public async Task SendOutboxMessages()
{
    var unsentMessages = await dbContext.OutboxMessages
        .Where(m => !m.IsSent)
        .ToListAsync();

    foreach (var message in unsentMessages)
    {
        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ –æ—á–µ—Ä–µ–¥—å (RabbitMQ, Kafka –∏ —Ç.–ø.)
        await messageSender.SendAsync(message.Type, message.Payload);

        message.IsSent = true;
    }

    await dbContext.SaveChangesAsync();
}
```

https://dev.to/christianzink/the-outbox-pattern-in-event-driven-asp-net-core-microservice-architectures-89
### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã
[Metanit –ø–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ C#](https://metanit.com/sharp/tutorial/1.1.php)
[Metanit –ø–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ Asp.Net Core](https://metanit.com/sharp/aspnet6/)

[–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –≥—É—Ä—É](https://refactoring.guru/ru/refactoring)
[–ü–∞—Ç—Ç–µ—Ä–Ω—ã –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è](https://refactoring.guru/ru/design-patterns)

[–ü–∞—Ç—Ç–µ—Ä–Ω—ã–π –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è](https://codelibrary.info/books/c-sharp/patterny-proektirovaniya-dlya-c-i-platformy-net-core?highlight=WyJjIl0=)
[–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –£–ª—É—á—à–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∫–æ–¥–∞](https://codelibrary.info/books/dlya-programmistov/refaktoring)

[–ü—Ä–æ—Å—Ç–æ–µ –æ–±—ä–µ–∫—Ç–Ω–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](https://codelibrary.info/books/dlya-programmistov/prostoe-obektno-orientirovannoe-proektirovanie)
[–ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API](https://codelibrary.info/books/dlya-programmistov/proektirovanie-arkhitektury-api)
[–ò—Å–∫—É—Å—Å—Ç–≤–æ —á–∏—Å—Ç–æ–≥–æ –∫–æ–¥–∞](https://codelibrary.info/best-books/c-sharp?highlight=WyJjIl0=)

[–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã](https://github.com/RefactoringGuru/design-patterns-csharp)
#### –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏
[–î–æ—Ä–æ–∂–Ω—ã–µ –∫–∞—Ä—Ç—ã Backend](https://roadmap.sh/backend)
[–î–æ—Ä–æ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞ Asp.Net Core](https://roadmap.sh/aspnet-core)
[–ê–ª–≥–æ—Ä–∏—Ç–º—ã](https://neetcode.io/roadmap)

https://www.youtube.com/watch?v=w8rRhAup4kg
https://www.youtube.com/watch?v=_8yZYhAkQjQ
https://www.youtube.com/watch?v=pFKwmEdwZZQ
https://neetcode.io/roadmap

---
## –ü—Ä–∞–∫—Ç–∏–∫–∞
–¶–µ–ª—å - –Ω–∞—É—á–∏—Ç—å—Å—è —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å CCC –≤ –ø—Ä–æ—Å—Ç—ã—Ö –≤–µ–±-—Å–µ—Ä–≤–∏—Å–∞—Ö
- –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —Å –ø–æ–º–æ—â—å—é Keycloak
- –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é Serlilog
- –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é Redis
- —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å ApiVersioning (Swagger)
- —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å HealthChecks –ø–æ–¥—Ö–æ–¥
- —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å OutboxPattern –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Quartz

---
## –£–ø—Ä–∞–∂–µ–Ω–∏—è
–ü—Ä–æ–¥–æ–ª–∂–∞–µ–º —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å –°–∏—Å—Ç–µ–º—É –≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è. –î–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–µ—Ä–≤–∏—Å –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ KeyCloak –∏ —Ä–µ–∞–ª–∏–∑—É–µ–º –º–µ—Ç–æ–¥—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–∑–≤–æ–ª—è—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –∏ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤—ã–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –Ω–∞—à–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
### 1
–î–æ–±–∞–≤—å—Ç–µ —Å–µ—Ä–≤–∏—Å –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ KeyCloak —Å –ø–æ–º–æ—â—å—é, –∫–æ—Ç–æ—Ä–æ–≥–æ –±—É–¥–µ–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é/–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–π—Ç–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –≤ API –Ω–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –¥–æ–±–∞–≤—å—Ç–µ –≤ –¥–æ–∫–µ—Ä –∫–æ–º–ø–æ–∑ —Ñ–∞–π–ª –Ω–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å
- –¥–æ–±–∞–≤—å—Ç–µ —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å KeyCloak
- –¥–æ–±–∞–≤—å—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –∞–¥–º–∏–Ω–∫–µ KeyCloak. test@test.com –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω –¥–æ—Å—Ç—É–ø–∞. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è Postman. –§–∞–π–ª –∏–º–ø–æ—Ä—Ç–∞ –ª–µ–∂–∏—Ç –≤ –∫–æ—Ä–Ω–µ
- –¥–æ–±–∞–≤—å—Ç–µ middleware –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- –¥–æ–±–∞–≤—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å KeyCloak, –∫–æ—Ç–æ—Ä—ã–µ –≤ –¥–∞–ª—å–Ω–µ–π—à–µ–º –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é (—Å–æ–∑–¥–∞–Ω–∏–µ) –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∏—Ö –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é/–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
  ![[Pasted image 20250520180818.png]]
### 2
–î–æ–±–∞–≤—å—Ç–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- —Ä–µ–∞–ª–∏–∑—É–π—Ç–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- —Ä–µ–∞–ª–∏–∑—É–π—Ç–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –ú–µ—Ç–æ–¥ Login
- —Ä–µ–∞–ª–∏–∑—É–π—Ç–µ –º–µ—Ç–æ–¥ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ GetLoginUser

3
–î–æ–±–∞–≤—å—Ç–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –†–æ–ª–µ–π. –î–ª—è —ç—Ç–æ–≥–æ —Å–æ–∑–¥–∞–π—Ç–µ —Ä–æ–ª—å Registered –¥–ª—è –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Ä–µ–∞–ª–∏–∑—É–π—Ç–µ –ª–æ–≥–∏–∫—É –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤–æ–∫—Ä—É–≥ –Ω–µ–µ
- –¥–æ–±–∞–≤—å—Ç–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–∏–ø–æ–≤ –î–æ—Å—Ç—É–ø–æ–≤ 
- –¥–æ–±–∞–≤—å—Ç–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–µ—Å—É—Ä—Å–∞–º  

4
–î–æ–±–∞–≤—å—Ç–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ—Å–Ω–æ–≤–µ —Ç–∏–ø–æ–≤ –î–æ—Å—Ç—É–ø–æ–≤. –î–ª—è —ç—Ç–æ–≥–æ —Å–æ–∑–¥–∞–π—Ç–µ –ø–æ–ª–∏—Ç–∏–∫—É –¥–æ—Å—Ç—É–ø–∞ "users:read"

5
–î–æ–±–∞–≤—å—Ç–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–µ—Å—É—Ä—Å–∞–º. –î–ª—è —ç—Ç–æ–≥–æ –ø—Ä–æ–∫–∏–¥—ã–≤–∞–π—Ç–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã, –≥–¥–µ –æ–Ω–∏ —Ç—Ä–µ–±—É—é—Ç—Å—è –∏ –¥–æ–±–∞–≤—å—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å —Ä–µ—Å—É—Ä—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é. –ù–∞ –ø—Ä–∏–º–µ—Ä–µ –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤

6
–î–æ–±–∞–≤—å—Ç–µ —Å–µ—Ä–≤–∏—Å –ª–æ–≥–≥–∏—Ä–æ–≤–∞–Ω–∏—è Serilog, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª–∏—Ç —Ö—Ä–∞–Ω–∏—Ç—å –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏
- –¥–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å –≤ –¥–æ–∫–µ—Ä –∫–æ–º–ø–æ–∑
- –ø–æ–¥–∫–ª—é—á–∏—Ç–µ Serilog –∫ API –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –µ–≥–æ —Ä–∞–±–æ—Ç—ã: –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –∑–∞–ø—Ä–æ—Å—ã –∏ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø–∏—à—É—Ç—Å—è –≤ —Å–µ—Ä–≤–∏—Å –ª–æ–≥–æ–≤
- –ø–æ –æ–¥–Ω–æ–º—É –∑–∞–ø—Ä–æ—Å—É –º–æ–∂–µ—Ç –±—ã—Ç—å –º–Ω–æ–≥–æ –ª–æ–≥–æ–≤ –∏ —Å–µ–π—á–∞—Å –æ–Ω–∏ –≤ –æ–¥–Ω–æ–π –∫—É—á–µ. –î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –æ—Ç–¥–µ–ª—è—Ç—å –ª–æ–≥–∏ —Ä–∞–∑–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞ –æ–±–æ–≥–∞—Ç–∏—Ç–µ –∏—Ö —Å –ø–æ–º–æ—â—å—é CorrelationId. –≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –≤–∏–¥–µ—Ç—å —Ü–µ–ø–æ—á–∫—É –ª–æ–≥–æ–≤ –æ–¥–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏ —Ç–æ–ª—å–∫–æ –¥–ª—è –Ω–µ–≥–æ
- –î–æ—Ä–∞–±–æ—Ç–∞–π—Ç–µ –ª–æ–≥–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –ª–æ–≥–≥–∏—Ä—É—é—Ç—Å—è (–Ω–µ —Ç–æ–ª—å–∫–æ –∫–æ–º–∞–Ω–¥—ã), –Ω–µ—É–¥–∞—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –∏ –æ—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –ª–æ–≥

7
–í –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –µ—Å—Ç—å –Ω–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –º–µ—Å—Ç–∞ –∑–∞–ø—Ä–æ—Å–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö: –ø–æ–ª—É—á–µ–Ω–∏–µ —Ä–æ–ª–µ–π/–¥–æ—Å—Ç—É–ø–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –æ—Ç —Å–µ—Ä–≤–∏—Å–∞ –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏. –≠—Ç–∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ –∏–∑–º–µ–Ω—è—é—Ç—Å—è –Ω–∞ –±–æ–ª—å—à–æ–º –ø—Ä–æ–º–µ–∂—É—Ç–∫–µ –≤—Ä–µ–º–µ–Ω–∏, –Ω–æ –º—ã –∏—Ö –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –∏ —Å–æ–∑–¥–∞–µ–º —Ç–µ–º —Å–∞–º—ã–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É, —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞ –∏ —Ç.–¥. 
–ü–æ—ç—Ç–æ–º—É –¥–æ–±–∞–≤–∏–º –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –ø–æ–∑–≤–æ–ª–∏—Ç —Ä–µ—à–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã.
- –¥–æ–±–∞–≤—å—Ç–µ —Å–µ—Ä–≤–∏—Å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è Redis
- –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–π—Ç–µ —Ä–∞–±–æ—Ç—É —Å –∫–µ—à–µ–º –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- –¥–æ—Ä–∞–±–æ—Ç–∞–π—Ç–µ AuthorizationService —Ç–∞–∫, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∞–µ–º—ã–µ —Ä–æ–ª–∏ –∏ –¥–æ—Å—Ç—É–ø—ã –∫–µ—à–∏—Ä–æ–≤–∞–ª–∏—Å—å
- –¥–æ—Ä–∞–±–æ—Ç–∞–π—Ç–µ —Å–ª–æ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Ç–∞–∫, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –∏–∑ –∫–æ—Ä–æ–±–∫–∏ –ø–æ–¥–∫–ª—é—á–∞—Ç—å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ —Å –ø–æ–º–æ—â—å—é –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –ø–∞–π–ø–ª–∞–π–Ω –Ω–æ–≤–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è –¥–ª—è –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è

8
–ß—Ç–æ–±—ã –±—ã—Ç—å –≤—Å–µ–≥–¥–∞ —É–≤–µ—Ä–µ–Ω–Ω—ã–º, —á—Ç–æ –≤–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–Ω–∞—Ç—å –æ –µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏–∏. –î–ª—è —ç—Ç–æ–≥–æ –¥–æ–±–∞–≤—å—Ç–µ –≤ API —Ç–∞–∫ –Ω–∞–∑—ã–≤–∞–µ–º—ã–µ healthcheck. –ú–µ—Ç–æ–¥—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
- –¥–æ–±–∞–≤—å—Ç–µ –≤ –æ–±—â–∏–π –ø–∞–π–ø–ª–∞–π–Ω –∑–∞–ø—Ä–æ—Å–∞ –º–∏–¥–ª–≤–∞—Ä—É –¥–ª—è healthcheck
- –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –∫–∞—Å—Ç–æ–º–Ω—ã–π healthcheck, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –°–£–ë–î, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –¥—Ä—É–≥–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ healthcheck –Ω–∞ –æ—Å–Ω–æ–≤–µ –≥–æ—Ç–æ–≤—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ –¥–æ–±–∞–≤–∏–≤ –±–∏–±–ª–∏–æ—Ç–µ–∫—É AspNetCore.HealthChecks.* –∏ –¥–æ–±–∞–≤–∏–≤ –≤ –ø–∞–π–ø–ª–∞–π–Ω –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

9
–í –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç –∏ –ø—Ä–µ—Ç–µ—Ä–ø–µ–≤–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è. –¢–µ–∫—É—â–∏–µ –º–µ—Ç–æ–¥—ã –º–æ–≥—É—Ç —É—Å—Ç–∞—Ä–µ—Ç—å –∏ –∂–¥–∞—Ç—å —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –∏–ª–∏ —É–¥–∞–ª–µ–Ω–∏—è. –ù–æ —Å API, –∫–æ—Ç–æ—Ä–æ–µ —è–≤–ª—è–µ—Ç—Å—è –ø—É–±–ª–∏—á–Ω—ã–º –¥–µ–ª–æ –æ–±—Å—Ç–æ–∏—Ç –∏–Ω–∞—á–µ. –í —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ —Ä–∞–±–æ—Ç–∞ –Ω–∞—à–µ–≥–æ API –º–µ–Ω—è–µ—Ç—Å—è, —Ç–æ –º—ã –Ω–µ –º–æ–∂–µ–º –ø—Ä–æ—Å—Ç–æ —Ç–∞–∫ –ø–æ–º–µ–Ω—è—Ç—å –ª–æ–≥–∏–∫—É. –ö—Ç–æ-—Ç–æ —É–∂–µ –µ–π –º–æ–∂–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∏ –Ω–∞—à–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –º–æ–≥—É—Ç –ø–æ–ª–æ–º–∞—Ç—å —Ä–∞–±–æ—Ç—É —ç—Ç–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤. –î–ª—è —ç—Ç–æ–≥–æ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ API. –ß—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –ø–æ–¥–Ω—è—Ç—å –≤–µ—Ä—Å–∏—é –∏ —Å—Ç–∞—Ä—É—é –æ–±–æ–∑–Ω–∞—á–∏—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à–µ–π, —á—Ç–æ–±—ã —Å –Ω–µ–µ –ø–µ—Ä–µ—à–ª–∏ –Ω–∞ –Ω–æ–≤—É—é. –î–æ–±–∞–≤—å—Ç–µ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- –¥–æ–±–∞–≤—å—Ç–µ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ API
- –¥–æ–±–∞–≤—å—Ç–µ 1 –∏ 2 –≤–µ—Ä–∏—Å—é –¥–ª—è UsersController –º–µ—Ç–æ–¥–∞ GetLoggedIn
- –¥–æ–±–∞–≤—å—Ç–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è OpenApi Swagger, —á—Ç–æ–±—ã –æ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–ª –≤–µ—Ä—Å–∏—é API –¥–ª—è –≤—Å–µ—Ö –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤

10
–†–∞–Ω–µ–µ –º—ã –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–ª–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏—é –¥–æ–º–µ–Ω–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π. –î–∞–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ–∫: –µ—Å–ª–∏ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç –æ—à–∏–±–∫–∞, —Ç–æ –¥–∞–Ω–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ –Ω–µ –±—É–¥–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ –∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–∞ –±—É–¥–µ—Ç –Ω–∞—Ä—É—à–µ–Ω–∞. –î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã —ç—Ç–æ–≥–æ –∏–∑–±–µ–∂–∞—Ç—å –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø–∞—Ç—Ç–µ—Ä–Ω OutboxMessage. –î–ª—è —ç—Ç–æ–≥–æ –º—ã –≤—Å–µ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã–µ —Å–æ–±—ã—Ç–∏—è –±—É–¥–µ–º –∫–ª–∞—Å—Ç—å –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–∞–º–∫–∞—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏. –ê –∑–∞—Ç–µ–º –≤ —Ñ–æ–Ω–æ–≤–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ –ø–æ–æ—á–µ—Ä–µ–¥–Ω–æ –∏—Ö –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å, —á—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –Ω–∞–º —Ä–µ—à–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ–∫.
- —Å–æ–∑–¥–∞–π—Ç–µ –º–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –≤ —Å–µ–±–µ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã–µ —Å–æ–±—ã—Ç–∏—è OutboxMessage
- –ø–µ—Ä–µ–¥–µ–ª–∞–π—Ç–µ –ø—É–±–ª–∏–∫–∞—Ü–∏—é –¥–æ–º–µ–Ω–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π –Ω–∞ –∏—Ö —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î
- –¥–æ–±–∞–≤—å—Ç–µ –±–∏–±–ª–∏–æ—Ç–µ–∫—É Quartz –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–æ–Ω–æ–≤—ã–º–∏ –∑–∞–¥–∞—á–∞–º–∏ –∏ —Ä–µ–∞–ª–∏–∑—É–π—Ç–µ —Ñ–æ–Ω–æ–≤—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –¥–æ–º–µ–Ω–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π

---
## FAQ
–ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–ª–∏ –≤–æ–ø—Ä–æ—Å—ã –ø–æ –∑–∞–Ω—è—Ç–∏—é –∏–ª–∏ –æ–±—â–∏–µ –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ [FAQ](https://docs.google.com/spreadsheets/d/1_n-wfeDpjv3-NcWxreu7minH0JQ-ooQb9B1KtNMU0eI/edit?usp=sharing)
–í–æ–∑–º–æ–∂–Ω–æ –æ—Ç–≤–µ—Ç —É–∂–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Ç–∞–º

–ï—Å–ª–∏ –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –≤–æ–ø—Ä–æ—Å —Ç–∞–º –Ω–µ—Ç. –ù–∞–ø–∏—à–∏—Ç–µ –µ–≥–æ –∏ —è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–∞–º –æ—Ç–≤–µ—Ç

**–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è**:
1. –ó–∞–ø—Ä–æ—Å–∏—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ç–∞–±–ª–∏—Ü–µ, –µ—Å–ª–∏ —É –≤–∞—Å –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞
2. –ï—Å–ª–∏ –≤–æ–ø—Ä–æ—Å –ø–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –∑–∞–Ω—è—Ç–∏—é, —Ç–æ–≥–¥–∞ –∑–∞–π–¥–∏—Ç–µ –≤–æ –≤–∫–ª–∞–¥–∫—É —Å **–Ω–∞–∑–≤–∞–Ω–∏–µ–º –∑–∞–Ω—è—Ç–∏—è**, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫ –≤–æ–ø—Ä–æ—Å, –∏–Ω–∞—á–µ –∑–∞–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **–û–±—â–∏–µ**
3. –ù–∞–ø–∏—à–∏—Ç–µ –í–æ–ø—Ä–æ—Å –≤ —Å—Ç–æ–ª–±—Ü–µ **–í–æ–ø—Ä–æ—Å**
4. –ù–∞–ø–∏—à–∏—Ç–µ –§–∞–º–∏–ª–∏—é –ò–º—è –≤ —Å—Ç–æ–ª–±—Ü–µ **–ê–≤—Ç–æ—Ä**
5. –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏—è
	1. –£–∫–∞–∂–∏—Ç–µ –°—Ç–∞—Ç—É—Å –û–∂–∏–¥–∞–µ—Ç 
	2. –î–æ–∂–¥–∏—Ç–µ—Å—å –æ—Ç–≤–µ—Ç–∞. –£ –≤–æ–ø—Ä–æ—Å–∞ –±—É–¥–µ—Ç —Å—Ç–∞—Ç—É—Å –û—Ç–≤–µ—Ç –¥–∞–Ω
	3. –ï—Å–ª–∏ –æ—Ç–≤–µ—Ç —Ç—Ä–µ–±—É–µ—Ç —É—Ç–æ—á–Ω–µ–Ω–∏—è –ø–µ—Ä–µ–≤–∏–¥—Ç–µ –≤–æ–ø—Ä–æ—Å –≤ —Å—Ç–∞—Ç—É—Å –¢—Ä–µ–±—É–µ—Ç —É—Ç–æ—á–Ω–µ–Ω–∏—è –∏ –Ω–∞–ø–∏—à–∏—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –≤ —Å—Ç–æ–ª–±—Ü–µ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
	4. –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ, –ø–æ–∫–∞ –Ω–µ –ø–æ–ª—É—á–∏—Ç–µ –æ—Ç–≤–µ—Ç –Ω–∞ —Å–≤–æ–π –≤–æ–ø—Ä–æ—Å
6. –ü–µ—Ä–µ–≤–µ–¥–∏—Ç–µ –æ—Ç–≤–µ—Ç –≤ —Å—Ç–∞—Ç—É—Å –ó–∞–≤–µ—Ä—à–µ–Ω
7. –ï—Å–ª–∏ –æ—Ç–≤–µ—Ç –≤–∞–º –ø–æ–º–æ–≥ —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è, —É–≤–µ–ª–∏—á—å—Ç–µ —á–∏—Å–ª–æ –≤ –∫–æ–ª–æ–Ω–∫–µ **–õ–∞–π–∫–∏**, —ç—Ç–æ –ø–æ–º–æ–∂–µ—Ç –ø–æ–Ω—è—Ç—å –Ω–∞—Å–∫–æ–ª—å–∫–æ —ç—Ç–∏ –≤–æ–ø—Ä–æ—Å—ã –æ–±—â–∏–µ –∏ –≤—ã–Ω–µ—Å—Ç–∏ –æ—Ç–≤–µ—Ç—ã –≤ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –∫—É—Ä—Å–∞

–°–ø–∞—Å–∏–±–æ, —á—Ç–æ –æ—Å—Ç–∞–≤–∏–ª–∏ –≤–æ–ø—Ä–æ—Å, –±–ª–∞–≥–æ–¥–∞—Ä—è —ç—Ç–æ–º—É –∫—É—Ä—Å –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å –ª—É—á—à–µ

---
## –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å
**–û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å**
–î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∫–æ–Ω—Ç—Ä–æ–ª—è –∑–∞ —Ä–∞–±–æ—Ç–æ–π —É—á–µ–Ω–∏–∫–æ–≤ –∏ —É–ª—É—á—à–µ–Ω–∏—è –∫—É—Ä—Å–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ** –æ—Å—Ç–∞–≤–∏—Ç—å [–æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å –ø–æ –∫—É—Ä—Å—É](https://docs.google.com/forms/d/e/1FAIpQLSfOZTyNNNA-GDpWapoh7g_fmHYYpO8_1ZnoWsDyQTubAHvrFw/viewform?usp=dialog)
–û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è —Ñ–∞–∫—Ç–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏, –Ω–æ –Ω–µ—Ç —Ü–µ–ª–∏ –∑–∞—Å—Ç–∞–≤–∏—Ç—å –≤–∞—Å —á—Ç–æ-—Ç–æ –ø–∏—Å–∞—Ç—å –≤ –Ω–µ–π, –µ—Å–ª–∏ –≤–∞–º –Ω–µ—á–µ–≥–æ —Å–∫–∞–∑–∞—Ç—å.

**–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å** (–ê–ù–û–ù–ò–ú–ù–ê–Ø)
–ï—Å–ª–∏ –≤–∞–º –µ—Å—Ç—å, —á—Ç–æ —Å–∫–∞–∑–∞—Ç—å –ø–æ –∑–∞–Ω—è—Ç–∏—è–º, –Ω–æ –≤—ã –ø–æ –∫–∞–∫–∏–º-—Ç–æ –ø—Ä–∏—á–∏–Ω–∞–º –Ω–µ –≥–æ—Ç–æ–≤—ã —ç—Ç–∏–º –ø–æ–¥–µ–ª–∏—Ç—å—Å—è –≤ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–π —Ñ–æ—Ä–º–µ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏, —Ç–æ –±—É–¥—É –æ—á–µ–Ω—å –±–ª–∞–≥–æ–¥–∞—Ä–µ–Ω, –µ—Å–ª–∏ –æ—Å—Ç–∞–≤–∏—Ç–µ –µ–µ –≤ [–∞–Ω–æ–Ω–∏–º–Ω–æ–π –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏](https://docs.google.com/forms/d/e/1FAIpQLSfvVEkllf7gLIlkZLLwKXgkLVbj2sHrX4wMT4dcCeICE-K1rQ/viewform?usp=dialog)
